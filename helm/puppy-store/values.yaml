# Default values for puppy-store

# JWT secret for auth (change in production!)
jwt:
  secret: "change-this-in-production"
  issuer: "puppy-store"  # Must match Kong JWT credential key

# ============ API GATEWAY (KONG) ============
kong:
  enabled: true

  replicaCount: 1

  image:
    repository: kong
    tag: "3.5"
    pullPolicy: IfNotPresent

  service:
    type: NodePort
    port: 8000
    nodePort: 30080  # Accessible at localhost:30080 locally

  admin:
    enabled: true  # Enable for local debugging
    port: 8001

  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 250m
      memory: 512Mi

# ============ REDIS ============
redis:
  enabled: true

  image:
    repository: redis
    tag: "7-alpine"
    pullPolicy: IfNotPresent

  service:
    port: 6379

  resources:
    limits:
      cpu: 250m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 64Mi

  # TTL configuration (in seconds)
  ttl:
    chatSession: 3600        # 1 hour - chat sessions
    recommendSession: 3600   # 1 hour - recommendation sessions
    descriptionCache: 86400  # 24 hours - AI-generated descriptions

# Azure Key Vault integration (recommended for production)
keyVault:
  enabled: false
  name: ""                    # Key Vault name (e.g., "puppy-store-kv")
  tenantId: ""                # Azure AD tenant ID
  userAssignedIdentityID: ""  # Managed identity client ID

# Database configuration
database:
  external: false
  host: ""
  port: 5432
  name: puppystore
  user: ""
  existingSecret: ""
  existingSecretKey: "password"

# Pod annotations
podAnnotations: {}

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}

# ============ AUTH SERVICE ============
auth:
  replicaCount: 1
  # Gateway mode: services trust X-Consumer-Custom-Id header from Kong
  # Standalone mode: services validate JWT directly (fallback for testing)
  authMode: gateway

  image:
    repository: puppy-store-auth
    tag: latest
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 80
    targetPort: 3001

  resources:
    limits:
      cpu: 250m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 128Mi

# ============ PUPPIES SERVICE ============
puppies:
  replicaCount: 1

  image:
    repository: puppy-store-puppies
    tag: latest
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 80
    targetPort: 3002

  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

# ============ CHAT SERVICE ============
chat:
  replicaCount: 1

  image:
    repository: puppy-store-chat
    tag: latest
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 80
    targetPort: 3004

  resources:
    limits:
      cpu: 250m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 128Mi

# ============ EXPERT SERVICE ============
expert:
  enabled: true
  replicaCount: 1

  image:
    repository: puppy-store-expert
    tag: latest
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 80
    targetPort: 3003

  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 256Mi

  llm:
    provider: openai
    openai:
      secretName: openai-secret
      secretKey: api-key
      model: gpt-5-nano
    local:
      baseUrl: http://host.docker.internal:11434/v1
      model: qwen2.5-3b-instruct
      embeddingBaseUrl: http://host.docker.internal:8081/v1

# ============ OBSERVABILITY ============
observability:
  sentry:
    enabled: false
    dsn: ""
  langsmith:
    enabled: false
    secretName: langsmith-secret
    secretKey: api-key
    project: puppy-store
  loki:
    enabled: false
    host: ""
  logLevel: info

# ============ INGRESS ============
ingress:
  enabled: false
  className: nginx
  host: ""
  tls:
    enabled: false
    secretName: ""
